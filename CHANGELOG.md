# é¡¹ç›®ç²¾ç®€ä¸ Docker åŒ–æ”¹é€ æ€»ç»“

## ğŸ“Š æ”¹é€ å‰åå¯¹æ¯”

### æ”¹é€ å‰ï¼ˆWindows æ‰“åŒ…ç‰ˆæœ¬ï¼‰
```
ä¿¡å‘/
â”œâ”€â”€ build/                    # PyInstaller æ„å»ºç›®å½•
â”œâ”€â”€ dist/                     # å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºç›®å½•
â”œâ”€â”€ __pycache__/              # Python ç¼“å­˜
â”œâ”€â”€ venv/                     # è™šæ‹Ÿç¯å¢ƒ
â”œâ”€â”€ build_exe.py              # PyInstaller æ‰“åŒ…è„šæœ¬
â”œâ”€â”€ build_exe.bat             # Windows æ‰¹å¤„ç†æ‰“åŒ…è„šæœ¬
â”œâ”€â”€ SignageSystemServer.spec  # PyInstaller é…ç½®
â”œâ”€â”€ run_multi_port.py         # Windows GUI å¯åŠ¨è„šæœ¬
â”œâ”€â”€ run.sh                    # æ—§å¯åŠ¨è„šæœ¬
â”œâ”€â”€ æºç signage_system.7z     # æºç å‹ç¼©åŒ…
â”œâ”€â”€ main.py                   # ä¸»åº”ç”¨ï¼ˆå« PyInstaller ä»£ç ï¼‰
â”œâ”€â”€ requirements.txt          # ä¾èµ–ï¼ˆå« pyinstallerï¼‰
â”œâ”€â”€ static/                   # å‰ç«¯æ–‡ä»¶
â”œâ”€â”€ images/                   # å›¾ç‰‡ç›®å½•
â””â”€â”€ devices.json              # è®¾å¤‡æ•°æ®
```

### æ”¹é€ åï¼ˆDocker ç‰ˆæœ¬ï¼‰
```
ä¿¡å‘/
â”œâ”€â”€ .dockerignore             # Docker æ„å»ºå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .env.example              # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore                # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ build-docker.bat          # Windows Docker æ„å»ºè„šæœ¬
â”œâ”€â”€ build-docker.sh           # Linux/Mac Docker æ„å»ºè„šæœ¬
â”œâ”€â”€ build-multiarch.sh        # å¤šæ¶æ„æ„å»ºè„šæœ¬
â”œâ”€â”€ devices.json              # è®¾å¤‡æ•°æ®ï¼ˆæŒä¹…åŒ–ï¼‰
â”œâ”€â”€ docker-compose.yml        # Docker Compose é…ç½®
â”œâ”€â”€ Dockerfile                # Docker é•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ main.py                   # ä¸»åº”ç”¨ï¼ˆå·²ä¼˜åŒ–ï¼‰
â”œâ”€â”€ QUICKSTART.md             # å¿«é€Ÿå¯åŠ¨æŒ‡å—
â”œâ”€â”€ README.md                 # å®Œæ•´æ–‡æ¡£
â”œâ”€â”€ requirements.txt          # ä¾èµ–ï¼ˆå·²ç²¾ç®€ï¼‰
â”œâ”€â”€ test-docker.bat           # Windows æµ‹è¯•è„šæœ¬
â”œâ”€â”€ test-docker.sh            # Linux/Mac æµ‹è¯•è„šæœ¬
â”œâ”€â”€ images/                   # å›¾ç‰‡ç›®å½•ï¼ˆæŒä¹…åŒ–ï¼‰
â”‚   â”œâ”€â”€ .gitkeep
â”‚   â”œâ”€â”€ default.jpg
â”‚   â””â”€â”€ ç©ºç™½ç›¾.png
â””â”€â”€ static/                   # å‰ç«¯æ–‡ä»¶
    â”œâ”€â”€ client.html
    â””â”€â”€ index.html
```

## âœ… å·²åˆ é™¤çš„æ–‡ä»¶

### PyInstaller ç›¸å…³
- âŒ `build_exe.py` - PyInstaller æ‰“åŒ…è„šæœ¬
- âŒ `build_exe.bat` - Windows æ‰¹å¤„ç†æ‰“åŒ…è„šæœ¬
- âŒ `SignageSystemServer.spec` - PyInstaller é…ç½®æ–‡ä»¶
- âŒ `run_multi_port.py` - Windows GUI å¯åŠ¨è„šæœ¬ï¼ˆå« tkinterï¼‰
- âŒ `run.sh` - æ—§çš„å¯åŠ¨è„šæœ¬

### æ„å»ºäº§ç‰©
- âŒ `build/` - PyInstaller æ„å»ºä¸´æ—¶ç›®å½•
- âŒ `dist/` - PyInstaller è¾“å‡ºç›®å½•ï¼ˆå« 17MB çš„ exe æ–‡ä»¶ï¼‰
- âŒ `__pycache__/` - Python ç¼“å­˜ç›®å½•
- âŒ `venv/` - è™šæ‹Ÿç¯å¢ƒç›®å½•

### å…¶ä»–
- âŒ `æºç signage_system.7z` - 43MB çš„æºç å‹ç¼©åŒ…

## ğŸ†• æ–°å¢çš„æ–‡ä»¶

### Docker é…ç½®
- âœ… `Dockerfile` - Docker é•œåƒæ„å»ºæ–‡ä»¶
- âœ… `docker-compose.yml` - Docker Compose é…ç½®
- âœ… `.dockerignore` - Docker æ„å»ºå¿½ç•¥æ–‡ä»¶

### æ„å»ºè„šæœ¬
- âœ… `build-docker.bat` - Windows Docker æ„å»ºè„šæœ¬
- âœ… `build-docker.sh` - Linux/Mac Docker æ„å»ºè„šæœ¬
- âœ… `build-multiarch.sh` - å¤šæ¶æ„ Docker æ„å»ºè„šæœ¬

### æµ‹è¯•è„šæœ¬
- âœ… `test-docker.bat` - Windows ç¯å¢ƒæµ‹è¯•è„šæœ¬
- âœ… `test-docker.sh` - Linux/Mac ç¯å¢ƒæµ‹è¯•è„šæœ¬

### æ–‡æ¡£
- âœ… `README.md` - å®Œæ•´çš„é¡¹ç›®æ–‡æ¡£
- âœ… `QUICKSTART.md` - å¿«é€Ÿå¯åŠ¨æŒ‡å—
- âœ… `CHANGELOG.md` - æœ¬æ–‡ä»¶

### é…ç½®
- âœ… `.gitignore` - Git å¿½ç•¥æ–‡ä»¶
- âœ… `.env.example` - ç¯å¢ƒå˜é‡ç¤ºä¾‹
- âœ… `images/.gitkeep` - ä¿æŒç›®å½•ç»“æ„

## ğŸ”§ ä¿®æ”¹çš„æ–‡ä»¶

### `main.py`
- ç§»é™¤äº† `resource_path()` å‡½æ•°ï¼ˆPyInstaller ä¸“ç”¨ï¼‰
- ç®€åŒ–äº† `STATIC_DIR` è·¯å¾„å¤„ç†é€»è¾‘
- ç§»é™¤äº† `sys` æ¨¡å—çš„å¯¼å…¥ï¼ˆä¸å†éœ€è¦ï¼‰
- æ›´æ–°äº†è¿è¡Œè¯´æ˜æ³¨é‡Š

### `requirements.txt`
- ç§»é™¤äº† `pyinstaller` ä¾èµ–
- å°† `uvicorn` æ”¹ä¸º `uvicorn[standard]`ï¼ˆåŒ…å«æ€§èƒ½ä¼˜åŒ–ï¼‰

## ğŸ“¦ Docker é•œåƒç‰¹æ€§

### åŸºç¡€é•œåƒ
- ä½¿ç”¨ `python:3.11-slim` ä½œä¸ºåŸºç¡€é•œåƒ
- é•œåƒå¤§å°çº¦ 200MBï¼ˆç›¸æ¯” exe çš„ 17MBï¼Œä½†åŒ…å«å®Œæ•´è¿è¡Œç¯å¢ƒï¼‰

### ä¼˜åŒ–æªæ–½
- ä½¿ç”¨æ¸…åå¤§å­¦ PyPI é•œåƒåŠ é€Ÿä¾èµ–å®‰è£…
- å¤šé˜¶æ®µæ„å»ºå‡å°é•œåƒä½“ç§¯
- è®¾ç½®æ—¶åŒºä¸º Asia/Shanghai
- å¥åº·æ£€æŸ¥è‡ªåŠ¨ç›‘æ§æœåŠ¡çŠ¶æ€

### æ•°æ®æŒä¹…åŒ–
- `images/` ç›®å½•é€šè¿‡ Docker å·æŒ‚è½½
- `devices.json` æ–‡ä»¶é€šè¿‡ Docker å·æŒ‚è½½
- å®¹å™¨é‡å¯æˆ–æ›´æ–°ä¸ä¼šä¸¢å¤±æ•°æ®

## ğŸš€ ä½¿ç”¨æ–¹å¼å¯¹æ¯”

### æ”¹é€ å‰ï¼ˆWindows exeï¼‰
```bash
# 1. è¿è¡Œ build_exe.bat æ‰“åŒ…
# 2. åŒå‡» dist/SignageSystemServer.exe
# 3. å¼¹å‡º tkinter çª—å£
# 4. æ‰‹åŠ¨æ‰“å¼€æµè§ˆå™¨
```

**ç¼ºç‚¹ï¼š**
- ä»…æ”¯æŒ Windows
- éœ€è¦é‡æ–°æ‰“åŒ…æ‰èƒ½æ›´æ–°
- ä¾èµ– tkinter å›¾å½¢ç•Œé¢
- éš¾ä»¥åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²

### æ”¹é€ åï¼ˆDockerï¼‰
```bash
# ä¸€é”®å¯åŠ¨
docker-compose up -d

# è®¿é—®
# http://localhost:8000/admin
```

**ä¼˜ç‚¹ï¼š**
- âœ… è·¨å¹³å°ï¼ˆWindows/Linux/Macï¼‰
- âœ… ä¸€é”®å¯åŠ¨å’Œåœæ­¢
- âœ… æ˜“äºæ›´æ–°å’Œå›æ»š
- âœ… é€‚åˆæœåŠ¡å™¨éƒ¨ç½²
- âœ… æ”¯æŒå¤šæ¶æ„ï¼ˆamd64/arm64ï¼‰
- âœ… æ•°æ®æŒä¹…åŒ–
- âœ… æ˜“äºæ‰©å±•å’Œé›†æˆ

## ğŸ“ˆ é¡¹ç›®å¤§å°å¯¹æ¯”

| é¡¹ç›® | æ”¹é€ å‰ | æ”¹é€ å | è¯´æ˜ |
|------|--------|--------|------|
| æºç å¤§å° | ~60MB | ~30KB | ç§»é™¤äº†æ„å»ºäº§ç‰©å’Œè™šæ‹Ÿç¯å¢ƒ |
| å¯æ‰§è¡Œæ–‡ä»¶ | 17MB exe | - | ä¸å†éœ€è¦ |
| Docker é•œåƒ | - | ~200MB | åŒ…å«å®Œæ•´ Python è¿è¡Œç¯å¢ƒ |
| å‹ç¼©åŒ… | 43MB | - | å·²åˆ é™¤ |

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### 1. æ¨é€åˆ° Docker Hub
```bash
# Windows
build-docker.bat

# Linux/Mac
bash build-docker.sh
```

### 2. åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²
```bash
# æ‹‰å–é•œåƒ
docker pull your-username/signage-system:latest

# å¯åŠ¨æœåŠ¡
docker-compose up -d
```

### 3. é…ç½®åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰
ä½¿ç”¨ Nginx æˆ– Traefik é…ç½® HTTPS å’ŒåŸŸåè®¿é—®

### 4. ç›‘æ§å’Œæ—¥å¿—
- ä½¿ç”¨ `docker-compose logs -f` æŸ¥çœ‹å®æ—¶æ—¥å¿—
- é›†æˆ Prometheus + Grafana ç›‘æ§ï¼ˆå¯é€‰ï¼‰

### 5. å¤‡ä»½ç­–ç•¥
å®šæœŸå¤‡ä»½ `images/` ç›®å½•å’Œ `devices.json` æ–‡ä»¶

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡é…ç½®**
   - å¤åˆ¶ `.env.example` ä¸º `.env`
   - ä¿®æ”¹ `DOCKER_USERNAME` ä¸ºä½ çš„ Docker Hub ç”¨æˆ·å

2. **ç«¯å£å†²çª**
   - å¦‚æœ 8000 ç«¯å£è¢«å ç”¨ï¼Œä¿®æ”¹ `docker-compose.yml`

3. **æ•°æ®è¿ç§»**
   - å¦‚æœä¹‹å‰æœ‰æ•°æ®ï¼Œå°† `devices.json` å¤åˆ¶åˆ°é¡¹ç›®æ ¹ç›®å½•
   - å°†å›¾ç‰‡æ–‡ä»¶å¤åˆ¶åˆ° `images/` ç›®å½•

4. **é˜²ç«å¢™è®¾ç½®**
   - ç¡®ä¿é˜²ç«å¢™å…è®¸ 8000 ç«¯å£è®¿é—®
   - å±€åŸŸç½‘å†…å…¶ä»–è®¾å¤‡éœ€è¦èƒ½è®¿é—®æœåŠ¡å™¨ IP

## ğŸ‰ æ€»ç»“

é€šè¿‡è¿™æ¬¡æ”¹é€ ï¼Œé¡¹ç›®ä» Windows ä¸“ç”¨çš„æ‰“åŒ…ç‰ˆæœ¬è½¬å˜ä¸ºè·¨å¹³å°çš„ Docker å®¹å™¨åŒ–åº”ç”¨ï¼š

- **ä»£ç æ›´ç®€æ´**ï¼šç§»é™¤äº† PyInstaller ç›¸å…³çš„å…¼å®¹ä»£ç 
- **éƒ¨ç½²æ›´ç®€å•**ï¼šä¸€é”®å¯åŠ¨ï¼Œæ— éœ€å¤æ‚é…ç½®
- **ç»´æŠ¤æ›´æ–¹ä¾¿**ï¼šå®¹å™¨åŒ–ç®¡ç†ï¼Œæ˜“äºæ›´æ–°å’Œå›æ»š
- **æ‰©å±•æ€§æ›´å¼º**ï¼šå¯ä»¥è½»æ¾é›†æˆåˆ° CI/CD æµç¨‹
- **è·¨å¹³å°æ”¯æŒ**ï¼šWindowsã€Linuxã€Mac éƒ½å¯ä»¥è¿è¡Œ

ç°åœ¨ä½ å¯ä»¥è½»æ¾åœ°å°†è¿™ä¸ªé¡¹ç›®éƒ¨ç½²åˆ°ä»»ä½•æ”¯æŒ Docker çš„ç¯å¢ƒä¸­ï¼
